{% extends 'base.html.twig' %}

{% block title %}Se connecter{% endblock %}

{% block body %}
<style>
	body {
		display: flex;
		justify-content: center;
		align-items: center;
		min-height: 100vh;
	}

	.login-container{
		max-width:420px;
		min-width:380px;
		margin:0rem auto;
		padding:1.5rem;
		border:1px solid #000000ff;
		border-radius:8px;
	}

	.username, .password {
		width: 100%;
		padding: .5rem;
		border: 1px solid #ccc;
		border-radius: 4px;
		box-sizing: border-box;
	}	

	.button{
		padding:.5rem 1rem;
		color:#fff;
		border:none;
		border-radius:4px;
		cursor:pointer;
	}

	.error{
		width: 100%;
		max-width: 400px;
		padding:1rem;
		background:#fee;
		color:#c33;
		border:1px solid #fcc;
		border-radius:8px;
		margin-top:1rem;
		text-align:left;
		position: absolute;
		bottom: 3rem;
	}

	.flash-close {
        background: transparent;
        border: none;
        font-size: 20px;
        line-height: 20px;
        cursor: pointer;
        color: inherit;
        opacity: 0.5;
        float:right;
    }
    .flash-close:hover {
        opacity: 0.7;
    }

	/* Styles flottants pour les champs */
	.floating-group {
		position: relative;
		margin-bottom: 1.2rem;
	}

	.floating-group input {
		width: 100%;
		padding: 0.75rem 0.5rem;
		padding-right: 2.5rem; /* espace pour l’icône */
		border: 1px solid #ccc;
		border-radius: 4px;
		outline: none;
		font-size: 1rem;
		background: none;
		box-sizing: border-box; /* garde largeur originale */
	}

	.floating-group label {
		position: absolute;
		top: 50%;
		left: 0.55rem;
		transform: translateY(-50%);
		color: #777;
		pointer-events: none;
		transition: 0.2s ease;
		background: white;
		padding: 0 0.2rem;
	}

	.floating-group input:focus + label,
	.floating-group input:not(:placeholder-shown) + label {
		top: -0.1rem;
		font-size: 0.8rem;
		color: #333;
	}

	/* Icône œil */
	.toggle-password {
		position: absolute;
		right: 0.6rem;
		top: 50%;
		transform: translateY(-50%);
		cursor: pointer;
		width: 22px;
		height: 22px;
		display: flex;
		align-items: center;
		justify-content: center;
		color: #777;
	}

	.toggle-password:hover {
		color: #333;
	}
</style>

<div class="login-container">
	<h1 style="margin-top:0">Se connecter</h1>

	<form action="{{ path('app_login') }}" method="post">
		<input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">

		<div class="floating-group">
			<input type="text" name="username" id="inputUsername" placeholder=" " required>
			<label for="inputUsername">Nom d'utilisateur</label>
		</div>

		<div class="floating-group">
			<input type="password" name="password" id="inputPassword" placeholder=" " required>
			<label for="inputPassword">Mot de passe</label>

			<!-- Icône œil barré -->
			<span class="toggle-password" onclick="togglePassword()">
				<svg id="eyeIcon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
						d="M13.875 18.825A10.05 10.05 0 0112 19c-5.523 0-10-4-10-7 
						   0-1.21.63-2.634 1.72-3.93m3.522-2.83A9.978 9.978 0 0112 5c5.523 0 10 4 10 7 
						   0 1.387-.63 2.864-1.72 4.17M15 12a3 3 0 11-6 0 3 3 0 016 0zm5 9L4 3"/>
				</svg>
			</span>
		</div>

		<div style="display:flex; justify-content:space-between; align-items:center;">
			<button type="submit" class="button" style="background:#0366d6;">Connexion</button>
			<button type="reset" class="button" style="background:#9b9b9b;">Annuler</button>
		</div>
	</form>
</div>

{% if error %}
	<div class="error">
		{{ error.messageKey|trans(error.messageData, 'security') }}
		<button class="flash-close" onclick="this.parentElement.remove()">×</button>
	</div>
{% endif %}

<script>
	function togglePassword() {
		const input = document.getElementById("inputPassword");
		const icon = document.getElementById("eyeIcon");

		if (input.type === "password") {
			input.type = "text";
			// Icône œil ouvert
			icon.innerHTML = `
			<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
				d="M1.5 12s4-7 10.5-7 10.5 7 10.5 7-4 7-10.5 7S1.5 12 1.5 12zm10.5 3a3 3 0 100-6 3 3 0 000 6z"/>`;
		} else {
			input.type = "password";
			// Icône œil barré
			icon.innerHTML = `
			<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
				d="M13.875 18.825A10.05 10.05 0 0112 19c-5.523 0-10-4-10-7 
				   0-1.21.63-2.634 1.72-3.93m3.522-2.83A9.978 9.978 0 0112 5c5.523 0 10 4 10 7 
				   0 1.387-.63 2.864-1.72 4.17M15 12a3 3 0 11-6 0 3 3 0 016 0zm5 9L4 3"/>`;
		}
	}
</script>
{% endblock %}
