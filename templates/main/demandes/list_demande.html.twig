{% extends 'base.html.twig' %}

{% block title %}Liste des demandes de consultation{% endblock %}

{% block body %}
{% include '_partial/nav.html.twig' %}
<style>
    .feed {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
        margin: 0 auto;
    }

    .card {
        background-color: #fff;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        overflow: hidden;
        transition: transform 0.2s, box-shadow 0.2s, background-color 0.2s;
        border: 1px solid #949090ff;
    }

    .card:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.12);
    }

    .card:has(.btn-image:hover) {
        background-color: rgba(124, 255, 152, 0.41);
        transition: background-color 0.5s ease;
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        border-bottom: 1px solid #eee;
    }

    .user-info {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .avatar img {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        object-fit: cover;
    }

    .name-grade {
        cursor: pointer;
        display: flex;
        flex-direction: column;
    }

    .name-grade .grade {
        font-weight: bold;
        color: #4267B2;
        margin-right: 0.3rem;
    }

    .name-grade .name {
        font-weight: 600;
    }

    .name-grade .matricule {
        font-size: 0.85rem;
        color: #666;
    }

    .date {
        font-size: 0.85rem;
        color: #999;
    }

    .card-body {
        padding: 1rem;
    }

    .flex-container {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
    }

    .info-block {
        flex: 1;
        min-width: 200px;
        border: 1px solid #ccc;
        border-radius: 8px;
        position: relative;
        padding: 1.5rem 1rem 1rem 1rem;
        background-color: #f9f9f9;
    }

    .info-block .label {
        position: absolute;
        top: -0.8rem;
        left: 1rem;
        background-color: #f9f9f9;
        padding: 0 0.5rem;
        font-weight: bold;
        font-size: 0.85rem;
        color: #333;
    }

    .info-block .content {
        margin-bottom: 0.8rem;
        white-space: pre-wrap;
    }

    .info-block .delivreur {
        font-size: 0.85rem;
        color: #555;
        border-top: 1px solid #ddd;
        padding-top: 0.3rem;
    }

    .btn-image {
        display: inline-block;
        cursor: pointer;
        transition: transform 0.2s ease;
    }

    .btn-image:hover {
        transform: scale(1.1);
    }

    @media (max-width: 1000px) {
        h1.page-title {
            margin-top: 4.3em !important;
        }
    }

    @media (max-width: 500px) {
        h1.page-title {
            font-size: 1.5rem !important;
        }
    }
    @media (max-width: 450px) {
        h1.page-title {
            margin-top: 5em !important;
        }
    }

</style>

<h1 class="page-title" style="text-align:left; margin:10rem 0 2rem 0; font-size:1.8rem; transition:.3s ease-in-out; ">
    Liste des consultations en attente
</h1>   

<div class="feed">
    {% for demande in Demandes %}
        <div class="card" data-aos="zoom-in" data-aos-duration="500">

            <!-- Header -->
            <div class="card-header">
                <div class="user-info">
                    <div class="avatar">
                        <svg fill="#000000" width="50px" height="50px" viewBox="0 0 32 32" id="icon" xmlns="http://www.w3.org/2000/svg">
                            <path d="M16,8a5,5,0,1,0,5,5A5,5,0,0,0,16,8Zm0,8a3,3,0,1,1,3-3A3.0034,3.0034,0,0,1,16,16Z"/>
                            <path d="M16,2A14,14,0,1,0,30,16,14.0158,14.0158,0,0,0,16,2ZM10,26.3765V25a3.0033,3.0033,0,0,1,3-3h6a3.0033,3.0033,0,0,1,3,3v1.3765a11.8989,11.8989,0,0,1-12,0Zm13.9925-1.4507A5.0016,5.0016,0,0,0,19,20H13a5.0016,5.0016,0,0,0-4.9925,4.9258,12,12,0,1,1,15.985,0Z"/>
                            <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" style="fill:none;" class="cls-1" width="32" height="32"/>
                        </svg>
                    </div>

                    <div class="name-grade">
                        <div style="display:flex; align-items:center; gap:0.3rem;">
                            <span class="grade" title="Grade: {{demande.Grade}}">{{ demande.Grade }}</span>
                            <span class="name" title="Nom: {{demande.Nom}}">{{ demande.Nom }}</span>
                        </div>
                        <span class="matricule" title= "Matricule: {{demande.Matricule}}">{{ demande.Matricule }}</span>
                    </div>
                </div>

                <div class="date">
                    {{ demande.Date ? demande.Date|date('d/m/Y') : '' }}
                </div>
            </div>

            <!-- Body -->
            <div class="card-body">
                <div class="flex-container">

                    <!-- MOTIF -->
                    <div class="info-block">
                        <div class="label">Motif</div>
                        <div class="content">{{ demande.Motif }}</div>
                        <div class="delivreur">{{ demande.DelivreurDeMotif }}</div>
                    </div>

                </div>

                <!-- Bouton Consulter remplacÃ© par image -->
                <div style="margin-top: 1rem; display:flex; justify-content:flex-end;">
                    <a href="{{ path('app_new_consultation_from_demande', {
                            'demandeId': demande.id
                        }) }}"
                        class="btn-image"
                    >
                        <svg width="40px" height="40px" fill="#000000" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                            viewBox="0 0 56 56" xml:space="preserve">
                        <g>
                            <g>
                            </g>
                            <g>
                                <path d="M12,24c3.309,0,6-2.691,6-6s-2.691-6-6-6s-6,2.691-6,6S8.691,24,12,24z M12,14c2.206,0,4,1.794,4,4s-1.794,4-4,4
                                    s-4-1.794-4-4S9.794,14,12,14z"/>
                                <path d="M44,24c3.309,0,6-2.691,6-6s-2.691-6-6-6s-6,2.691-6,6S40.691,24,44,24z M44,14c2.206,0,4,1.794,4,4s-1.794,4-4,4
                                    s-4-1.794-4-4S41.794,14,44,14z"/>
                                <path d="M54,26v13c0,1.654-1.346,3-3,3V31c0-2.757-2.243-5-5-5h-5c-0.552,0-1,0.448-1,1v4v1v1h-8c-0.552,0-1,0.448-1,1v3h-6v-3
                                    c0-0.552-0.448-1-1-1h-8v-1v-1v-4c0-0.552-0.448-1-1-1h-5c-2.757,0-5,2.243-5,5v11c-1.654,0-3-1.346-3-3V26H0v13
                                    c0,2.045,1.237,3.802,3,4.576V56h2V44h1h1h8v11c0,0.552,0.448,1,1,1h3h1h1v-1V40v-1h3h8h3v1v15v1h1h1h3c0.552,0,1-0.448,1-1V44h8
                                    h1h1v12h2V43.576c1.763-0.774,3-2.531,3-4.576V26H54z M20,37h-2h-6v-6h-2v7c0,0.552,0.448,1,1,1h7c0.551,0,1,0.449,1,1v14h-2V43
                                    c0-0.552-0.448-1-1-1H7V31c0-1.654,1.346-3,3-3h4v3v1v2c0,0.552,0.448,1,1,1h8v2H20z M40,42c-0.552,0-1,0.448-1,1v11h-2V40
                                    c0-0.551,0.449-1,1-1h7c0.552,0,1-0.448,1-1v-7h-2v6h-6h-2h-3v-2h8c0.552,0,1-0.448,1-1v-2v-1v-3h4c1.654,0,3,1.346,3,3v11H40z"/>
                                <path d="M19,10v3c0,0.431,0.275,0.812,0.684,0.949C19.788,13.983,19.895,14,20,14c0.309,0,0.607-0.144,0.8-0.4l2.7-3.6H31
                                    c1.654,0,3-1.346,3-3V3c0-1.654-1.346-3-3-3H19c-1.654,0-3,1.346-3,3v4C16,8.654,17.346,10,19,10z M18,3c0-0.551,0.449-1,1-1h12
                                    c0.551,0,1,0.449,1,1v4c0,0.551-0.449,1-1,1h-8c-0.315,0-0.611,0.148-0.8,0.4L21,10V9c0-0.552-0.448-1-1-1h-1
                                    c-0.551,0-1-0.449-1-1V3z"/>
                                <rect x="20" y="4" width="10" height="2"/>
                                <rect x="27" y="25" width="6" height="2"/>
                                <path d="M26,21c-1.654,0-3,1.346-3,3v4c0,1.654,1.346,3,3,3h8c1.654,0,3-1.346,3-3v-0.697l1.832-2.748
                                    c0.205-0.307,0.224-0.701,0.05-1.026C38.708,23.203,38.369,23,38,23h-1.171c-0.413-1.164-1.525-2-2.829-2H26z M35,24
                                    c0,0.552,0.448,1,1,1h0.131l-0.963,1.445C35.059,26.609,35,26.803,35,27v1c0,0.551-0.449,1-1,1h-8c-0.551,0-1-0.449-1-1v-4
                                    c0-0.551,0.449-1,1-1h8C34.551,23,35,23.449,35,24z"/>
                                <rect x="23" y="16" width="2" height="2"/>
                                <rect x="27" y="16" width="2" height="2"/>
                                <rect x="31" y="16" width="2" height="2"/>
                            </g>
                        </g>
                        </svg>
                    </a>
                </div>

            </div>

        </div>
    {% else %}
        <p style="text-align:center;">Aucune demande de consultation pour l'instant.</p>
    {% endfor %}
</div>
<script>
    AOS.init();
</script>

{% include '_partial/footer.html.twig' %}
{% endblock %}
